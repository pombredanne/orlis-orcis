Orlis library class detection tool for Android apps.

## Library File Generation:
To detect library classes, a library repository should be built using the
library jar file. To generate the library file for a particular library jar,
run command in current directory:

```
./run.py <path of library jar file>  <output directory>
```

## Library Class Detection:
To detect library classes for a given APK file, run command in current
directory:

```
./run.py <path of APK file> <path of the library repository(including all library files)>
```

## Output Format 
The output is a list of class pairs in the format of
<app class, lib class> printed on the screen.


## Open-Source Apps Benchmarks
### Apps:
The open-source apps are from F-droid repository. They are in the tar.gz file
"./open_source_benchmarks/apps.tar.gz". There is a number with underscore in the
name of each apk; this number is to distinguish apks when they have the same name.

### Libraries:
The library jar files in this benchmark are in zip file
"./open_source_benchmarks/libraries.zip".

### Obfuscators:
The obfuscators used in our evaluation are 
* ProGuard 5.2.1
* Allatori Obfuscator v5.9 Educational
* DashO 8.0.0

The configuration file of each obfuscator is available at:
* ProGuard: ./open_source_benchmarks/obfuscator_configs/proguard_config.txt
* Allatori: ./open_source_benchmarks/obfuscator_configs/allatori_config.xml
* DashO   : ./open_source_benchmarks/obfuscator_configs/dasho_config.dox

### Ground Truth:
 The ground truth for unobfuscated apps is in file
"./open_source_benchmarks/ground_truth.txt". Each line is in the
format of "\<app\>: \<lib jar\>, \<lib jar\>, ...". \<lib jar\> is the
library jar used in the app. 
   
As for obfuscated apps, applying the obfuscator and a mapping file
will be generated. In the mapping file, the class signature before
and after obfuscation will be shown. For example:
"org.apache.commons.codec.net.URLCodec -> wy.ael" is a case in the
mapping file of ProGuard. It means
"org.apache.commons.codec.net.URLCodec" is renamed to "wy.ael" in
the corresponding obfuscated app. Both Allatori and DashO have a similar mapping
file. Based on the mapping file and the ground truth for
unobfuscated apps, the ground truth for obfuscated apps can be
built. Please refer to the document of each obfuscator for the
details about how to get the mapping files. The links of the
documents are shown as below: 

* ProGuard: https://www.guardsquare.com/en/proguard
* Allatori: http://www.allatori.com/doc.html
* DashO: https://www.preemptive.com/products/dasho/videos-a-resources (need request)

### Replication of Experimental Results from MOBILESoft’18 paper:
* Obfuscate the apps using the obfuscators with the corresponding config files and get the mapping files for each app.
Alternatively, you can use the obfuscated apps available in "./open_source_benchmarks/\[proguard|allatori|dasho\]_apks".
* Build the ground truth for obfuscated apps using the ground truth for unobfuscated apps and the mapping files. Alternatively, you can use the mappings files generated by the corresponding obfuscator, which are available in "./open_source_benchmarks/\[proguard|allatori|dasho\]_mappings"
* Build the library repository using the library jar files.
* Run Orlis on each obfuscated app.
* Measure the performance using the result of Orlis and the ground truth.

## Closed-Source Apps Benchmarks
The libraries and apps in closed-source apps benchmarks can be found on the
website of
[LibDetect](http://www.st.informatik.tu-darmstadt.de/artifacts/codematch/).

Based on the library list from the LibDetect web page, we have managed to obtain 7519 libraries out of 
those listed at the LibDetect web site. The names of library jar we successfully downloaded could be found
in "closed_apps_benchmarks/library_list.txt". As described in the MOBILESoft’18 paper, we obtained 712 apps that matched the ones used in the evaluation of LibDetect. The list of these apps is available at “closed_source_benchmarks/apps_list.txt”
It contains all the hashes of the apps 
that could be used to download the apps from [AndroZoo](https://androzoo.uni.lu/).  .

To run the experiment in the paper, build the library repository
using the library jars and run Orlis on each app. The ground truth for package-level mapping
can be obtained from the authors of CodeMatch. For more details,
please refer to the
[website](http://www.st.informatik.tu-darmstadt.de/artifacts/codematch/).
